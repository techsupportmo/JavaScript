<!DOCTYPE html>
<html>

<head>
    <title>World Temperature Data</title>

    <!-- Importing Chart.js-->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.6.2/dist/chart.min.js"></script>

</head>

<body>

    <!-- Creating canvas -->
    <canvas id="chart" width="400" height="400"></canvas>

    <script>
        // Temperature Data from: https://data.giss.nasa.gov/gistemp/
        // Mean from: https://earthobservatory.nasa.gov/world-of-change/global-temperatures


        function createChart()
        {
            //CODE THAT IS COPY PASTED
            // -----------------------------------------------------------------------------------

        
            const ctx = document.getElementById('chart').getContext('2d');

            // Created array to store labels on the x axis 
            const xlabels = [];

            const myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: xlabels,
                    datasets: [{
                        label: 'Global Average Temperature',
                        data: [12, 19, 3, 5, 2, 3],
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.2)',
                            'rgba(54, 162, 235, 0.2)',
                            'rgba(255, 206, 86, 0.2)',
                            'rgba(75, 192, 192, 0.2)',
                            'rgba(153, 102, 255, 0.2)',
                            'rgba(255, 159, 64, 0.2)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });


            // -----------------------------------------------------------------------------------

        }



        getData();

        // function to fetch CSV file
        // Uses async/await because it is an asynchronous function
        async function getData()
        {
            const response = await fetch('ZonAnn.Ts+dSST.csv');
            const data = await response.text();
            //console.log(data)

            // split() -
            // splitting the entire table into indivdiual rows (seperate by newline) 
            // and storing into an array

            // slice() - 
            // makes a copy of a portion of an array - from index 1 to the end
            // This essentially removes the first row (with the headings)

            table = data.split('\n').slice(1);

            // foreach() - This allows us to apply something to each element fo the array
            table.forEach(row => 
            {
                // Splits each row into individual elements (columns)
                const columns = row.split(',');
                
                // Prints out row broken into individual elements (columns)
                //console.log(columns);

                // Stores year (first element of each row)
                const year = columns[0];

                // Stores temperature (second element of each row)
                const temp = columns[1];

                // Now that year and temperature are stored, we store them into xlabels array
                xlabels.push(year)

                // Prints out YEAR and TEMPERATURE for each row of the table
                console.log(year,temp);
            })

            
        }
        

    </script>
</body>

</html>